def TEST = UnitTest.new("NumberParser", test);

def test() {
	n("-");

	var hex_buf = "0xx";
	var neg_buf = "-x";
	var pos_buf = "x";
	var alpha = "acbdefghijklmnopqrstuvABCDEFGHIJKLMNOPQRSTUVWXYZ";
	var symbol =  "`~!@#$%^&*()_=+[{]}|;:,<.>/?";
	var quote = "\\\'\"";
	for (s in [alpha, symbol, quote]) {
		for (ch in s) {
			neg_buf[1] = ch;
			n(neg_buf);
			pos_buf[0] = ch;
			n(pos_buf);
		}
	}

	for (ch in symbol) {
		hex_buf[2] = ch;
		n(hex_buf);
	}
	for (ch = 'G'; ch <= 'Z'; ch++) {
		hex_buf[2] = ch;
		n(hex_buf);
	}
	for (ch = 'g'; ch <= 'z'; ch++) {
		hex_buf[2] = ch;
		n(hex_buf);
	}

	testInts();
	testHexLongs();
	testDecLongs();
	testUnsigned();
	testTypes();
	testFloatTypes();
	testInvalidFloats();
	testFractional();
	testExponent();
	testFloatVal();
	testDoubleVal();
}

def testInts() {
 	def test = test_implicit_int;

	test(0,			"0",		"0x0",		"0b0");
	test(0,			"0",		"0x000",	"0b0000");
	test(0,			"0",		"0X0",		"0B0");
	test(0,			"0",		"0X000",	"0B0000");
	test(1,			"1",		"0x1",		"0b1");
	test(-1,		"-1",		"0xffffffff",	"0b11111111111111111111111111111111");
	test(2,			"2",		"0x2",		"0b10");
	test(-2,		"-2",		"0xfffffffe",	"0b11111111111111111111111111111110");
	test(3,			"3",		"0x3",		"0b11");
	test(-3,		"-3",		"0xfffffffd",	"0b11111111111111111111111111111101");
	test(4,			"4",		"0x4",		"0b100");
	test(-4,		"-4",		"0xfffffffc",	"0b11111111111111111111111111111100");
	test(5,			"5",		"0x5",		"0b101");
	test(-5,		"-5",		"0xfffffffb",	"0b11111111111111111111111111111011");
	test(-6,		"-6",		"0xfffffffa",	"0b11111111111111111111111111111010");
	test(6,			"6",		"0x6",		"0b110");
	test(7,			"7",		"0x7",		"0b111");
	test(-7,		"-7",		"0xfffffff9",	"0b11111111111111111111111111111001");
	test(8,			"8",		"0x8",		"0b1000");
	test(-8,		"-8",		"0xfffffff8",	"0b11111111111111111111111111111000");
	test(9,			"9",		"0x9",		"0b1001");
	test(-9,		"-9",		"0xfffffff7",	"0b11111111111111111111111111110111");
	test(10,		"10",		"0xa",		"0b1010");
	test(-10,		"-10",		"0xfffffff6",	"0b11111111111111111111111111110110");
	test(11,		"11",		"0xb",		"0b1011");
	test(-11,		"-11",		"0xfffffff5",	"0b11111111111111111111111111110101");
	test(12,		"12",		"0xc",		"0b1100");
	test(-12,		"-12",		"0xfffffff4",	"0b11111111111111111111111111110100");
	test(13,		"13",		"0xd",		"0b1101");
	test(-13,		"-13",		"0xfffffff3",	"0b11111111111111111111111111110011");
	test(14,		"14",		"0xe",		"0b1110");
	test(-14,		"-14",		"0xfffffff2",	"0b11111111111111111111111111110010");
	test(15,		"15",		"0xf",		"0b1111");
	test(-15,		"-15",		"0xfffffff1",	"0b11111111111111111111111111110001");
	test(16,		"16",		"0x10",		"0b10000");
	test(-16,		"-16",		"0xfffffff0",	"0b11111111111111111111111111110000");
	test(17,		"17",		"0x11",		"0b10001");
	test(-17,		"-17",		"0xffffffef",	"0b11111111111111111111111111101111");
	test(18,		"18",		"0x12",		"0b10010");
	test(-18,		"-18",		"0xffffffee",	"0b11111111111111111111111111101110");
	test(23,		"23",		"0x17",		"0b10111");
	test(-23,		"-23",		"0xffffffe9",	"0b11111111111111111111111111101001");
	test(42,		"42",		"0x2a",		"0b101010");
	test(-42,		"-42",		"0xffffffd6",	"0b11111111111111111111111111010110");
	test(56,		"56",		"0x38",		"0b111000");
	test(-56,		"-56",		"0xffffffc8",	"0b11111111111111111111111111001000");
	test(1000000000,	"1000000000",	"0x3b9aca00",	"0b111011100110101100101000000000");
	test(1000000000,	"1000000000",	"0x3B9ACA00",	"0b111011100110101100101000000000");
	test(2000000000,	"2000000000",	"0x77359400",	"0b1110111001101011001010000000000");
	test(2000000000,	"2000000000",	"0x77359400",	"0b1110111001101011001010000000000");
	test(999999999, 	"999999999",	"0x3b9ac9ff",	"0b111011100110101100100111111111");
	test(1000000001, 	"1000000001",	"0x3b9aca01",	"0b111011100110101100101000000001");
	test(1999999999, 	"1999999999",	"0x773593ff",	"0b1110111001101011001001111111111");
	test(2000000001, 	"2000000001",	"0x77359401",	"0b1110111001101011001010000000001");
	test(999999998, 	"999999998",	"0x3b9ac9fe",	"0b111011100110101100100111111110");
	test(1000000002, 	"1000000002",	"0x3b9aca02",	"0b111011100110101100101000000010");
	test(1999999998, 	"1999999998",	"0x773593fe",	"0b1110111001101011001001111111110");
	test(2000000002, 	"2000000002",	"0x77359402",	"0b1110111001101011001010000000010");
	test(999999997, 	"999999997",	"0x3b9ac9fd",	"0b111011100110101100100111111101");
	test(1000000003, 	"1000000003",	"0x3b9aca03",	"0b111011100110101100101000000011");
	test(1999999997, 	"1999999997",	"0x773593fd",	"0b1110111001101011001001111111101");
	test(2000000003, 	"2000000003",	"0x77359403",	"0b1110111001101011001010000000011");
	test(999999996, 	"999999996",	"0x3b9ac9fc",	"0b111011100110101100100111111100");
	test(1000000004, 	"1000000004",	"0x3b9aca04",	"0b111011100110101100101000000100");
	test(1999999996, 	"1999999996",	"0x773593fc",	"0b1110111001101011001001111111100");
	test(2000000004, 	"2000000004",	"0x77359404",	"0b1110111001101011001010000000100");
	test(999999995, 	"999999995",	"0x3b9ac9fb",	"0b111011100110101100100111111011");
	test(1000000005, 	"1000000005",	"0x3b9aca05",	"0b111011100110101100101000000101");
	test(1999999995, 	"1999999995",	"0x773593fb",	"0b1110111001101011001001111111011");
	test(2000000005, 	"2000000005",	"0x77359405",	"0b1110111001101011001010000000101");
	test(999999994, 	"999999994",	"0x3b9ac9fa",	"0b111011100110101100100111111010");
	test(1000000006, 	"1000000006",	"0x3b9aca06",	"0b111011100110101100101000000110");
	test(1999999994, 	"1999999994",	"0x773593fa",	"0b1110111001101011001001111111010");
	test(2000000006, 	"2000000006",	"0x77359406",	"0b1110111001101011001010000000110");
	test(999999993, 	"999999993",	"0x3b9ac9f9",	"0b111011100110101100100111111001");
	test(1000000007, 	"1000000007",	"0x3b9aca07",	"0b111011100110101100101000000111");
	test(1999999993, 	"1999999993",	"0x773593f9",	"0b1110111001101011001001111111001");
	test(2000000007, 	"2000000007",	"0x77359407",	"0b1110111001101011001010000000111");
	test(999999992, 	"999999992",	"0x3b9ac9f8",	"0b111011100110101100100111111000");
	test(1000000008, 	"1000000008",	"0x3b9aca08",	"0b111011100110101100101000001000");
	test(1999999992, 	"1999999992",	"0x773593f8",	"0b1110111001101011001001111111000");
	test(2000000008, 	"2000000008",	"0x77359408",	"0b1110111001101011001010000001000");
	test(999999991, 	"999999991",	"0x3b9ac9f7",	"0b111011100110101100100111110111");
	test(1000000009, 	"1000000009",	"0x3b9aca09",	"0b111011100110101100101000001001");
	test(1999999991, 	"1999999991",	"0x773593f7",	"0b1110111001101011001001111110111");
	test(2000000009, 	"2000000009",	"0x77359409",	"0b1110111001101011001010000001001");
	test(999999990, 	"999999990",	"0x3b9ac9f6",	"0b111011100110101100100111110110");
	test(1000000010, 	"1000000010",	"0x3b9aca0a",	"0b111011100110101100101000001010");
	test(1999999990, 	"1999999990",	"0x773593f6",	"0b1110111001101011001001111110110");
	test(2000000010, 	"2000000010",	"0x7735940a",	"0b1110111001101011001010000001010");
	test(999999989, 	"999999989",	"0x3b9ac9f5",	"0b111011100110101100100111110101");
	test(1000000011, 	"1000000011",	"0x3b9aca0b",	"0b111011100110101100101000001011");
	test(1999999989, 	"1999999989",	"0x773593f5",	"0b1110111001101011001001111110101");
	test(2000000011, 	"2000000011",	"0x7735940b",	"0b1110111001101011001010000001011");
	test(999999988, 	"999999988",	"0x3b9ac9f4",	"0b111011100110101100100111110100");
	test(1000000012, 	"1000000012",	"0x3b9aca0c",	"0b111011100110101100101000001100");
	test(1999999988, 	"1999999988",	"0x773593f4",	"0b1110111001101011001001111110100");
	test(2000000012, 	"2000000012",	"0x7735940c",	"0b1110111001101011001010000001100");
	test(999999987, 	"999999987",	"0x3b9ac9f3",	"0b111011100110101100100111110011");
	test(1000000013, 	"1000000013",	"0x3b9aca0d",	"0b111011100110101100101000001101");
	test(1999999987, 	"1999999987",	"0x773593f3",	"0b1110111001101011001001111110011");
	test(2000000013, 	"2000000013",	"0x7735940d",	"0b1110111001101011001010000001101");
	test(999999986, 	"999999986",	"0x3b9ac9f2",	"0b111011100110101100100111110010");
	test(1000000014, 	"1000000014",	"0x3b9aca0e",	"0b111011100110101100101000001110");
	test(1999999986, 	"1999999986",	"0x773593f2",	"0b1110111001101011001001111110010");
	test(2000000014, 	"2000000014",	"0x7735940e",	"0b1110111001101011001010000001110");
	test(999999985, 	"999999985",	"0x3b9ac9f1",	"0b111011100110101100100111110001");
	test(1000000015, 	"1000000015",	"0x3b9aca0f",	"0b111011100110101100101000001111");
	test(1999999985, 	"1999999985",	"0x773593f1",	"0b1110111001101011001001111110001");
	test(2000000015, 	"2000000015",	"0x7735940f",	"0b1110111001101011001010000001111");
	test(999999984, 	"999999984",	"0x3b9ac9f0",	"0b111011100110101100100111110000");
	test(1000000016, 	"1000000016",	"0x3b9aca10",	"0b111011100110101100101000010000");
	test(1999999984, 	"1999999984",	"0x773593f0",	"0b1110111001101011001001111110000");
	test(2000000016, 	"2000000016",	"0x77359410",	"0b1110111001101011001010000010000");
	test(999999983, 	"999999983",	"0x3b9ac9ef",	"0b111011100110101100100111101111");
	test(1000000017, 	"1000000017",	"0x3b9aca11",	"0b111011100110101100101000010001");
	test(1999999983, 	"1999999983",	"0x773593ef",	"0b1110111001101011001001111101111");
	test(2000000017, 	"2000000017",	"0x77359411",	"0b1110111001101011001010000010001");
	test(999999982, 	"999999982",	"0x3b9ac9ee",	"0b111011100110101100100111101110");
	test(1000000018, 	"1000000018",	"0x3b9aca12",	"0b111011100110101100101000010010");
	test(1999999982, 	"1999999982",	"0x773593ee",	"0b1110111001101011001001111101110");
	test(2000000018, 	"2000000018",	"0x77359412",	"0b1110111001101011001010000010010");
	test(999999977, 	"999999977",	"0x3b9ac9e9",	"0b111011100110101100100111101001");
	test(1000000023, 	"1000000023",	"0x3b9aca17",	"0b111011100110101100101000010111");
	test(1999999977, 	"1999999977",	"0x773593e9",	"0b1110111001101011001001111101001");
	test(2000000023, 	"2000000023",	"0x77359417",	"0b1110111001101011001010000010111");
	test(999999958, 	"999999958",	"0x3b9ac9d6",	"0b111011100110101100100111010110");
	test(1000000042, 	"1000000042",	"0x3b9aca2a",	"0b111011100110101100101000101010");
	test(1999999958, 	"1999999958",	"0x773593d6",	"0b1110111001101011001001111010110");
	test(2000000042, 	"2000000042",	"0x7735942a",	"0b1110111001101011001010000101010");
	test(999999944, 	"999999944",	"0x3b9ac9c8",	"0b111011100110101100100111001000");
	test(1000000056, 	"1000000056",	"0x3b9aca38",	"0b111011100110101100101000111000");
	test(1999999944, 	"1999999944",	"0x773593c8",	"0b1110111001101011001001111001000");
	test(2000000056, 	"2000000056",	"0x77359438",	"0b1110111001101011001010000111000");
	test(77,		"77",		"0x4d",		"0b1001101");
	test(-77,		"-77",		"0xffffffb3",	"0b11111111111111111111111110110011");
	test(999999923, 	"999999923",	"0x3b9ac9b3",	"0b111011100110101100100110110011");
	test(1000000077, 	"1000000077",	"0x3b9aca4d",	"0b111011100110101100101001001101");
	test(1999999923, 	"1999999923",	"0x773593b3",	"0b1110111001101011001001110110011");
	test(2000000077, 	"2000000077",	"0x7735944d",	"0b1110111001101011001010001001101");
	test(101,		"101",		"0x65",		"0b1100101");
	test(-101,		"-101",		"0xffffff9b",	"0b11111111111111111111111110011011");
	test(999999899, 	"999999899",	"0x3b9ac99b",	"0b111011100110101100100110011011");
	test(1000000101, 	"1000000101",	"0x3b9aca65",	"0b111011100110101100101001100101");
	test(1999999899, 	"1999999899",	"0x7735939b",	"0b1110111001101011001001110011011");
	test(2000000101, 	"2000000101",	"0x77359465",	"0b1110111001101011001010001100101");
	test(125,		"125",		"0x7d",		"0b1111101");
	test(-125,		"-125",		"0xffffff83",	"0b11111111111111111111111110000011");
	test(999999875, 	"999999875",	"0x3b9ac983",	"0b111011100110101100100110000011");
	test(1000000125, 	"1000000125",	"0x3b9aca7d",	"0b111011100110101100101001111101");
	test(1999999875, 	"1999999875",	"0x77359383",	"0b1110111001101011001001110000011");
	test(2000000125, 	"2000000125",	"0x7735947d",	"0b1110111001101011001010001111101");
	test(1001,		"1001",		"0x3e9",	"0b1111101001");
	test(-1001,		"-1001",	"0xfffffc17",	"0b11111111111111111111110000010111");
	test(999998999, 	"999998999",	"0x3b9ac617",	"0b111011100110101100011000010111");
	test(1000001001, 	"1000001001",	"0x3b9acde9",	"0b111011100110101100110111101001");
	test(1999998999, 	"1999998999",	"0x77359017",	"0b1110111001101011001000000010111");
	test(2000001001, 	"2000001001",	"0x773597e9",	"0b1110111001101011001011111101001");
	test(1120,		"1120",		"0x460",	"0b10001100000");
	test(-1120,		"-1120",	"0xfffffba0",	"0b11111111111111111111101110100000");
	test(999998880, 	"999998880",	"0x3b9ac5a0",	"0b111011100110101100010110100000");
	test(1000001120, 	"1000001120",	"0x3b9ace60",	"0b111011100110101100111001100000");
	test(1999998880, 	"1999998880",	"0x77358fa0",	"0b1110111001101011000111110100000");
	test(2000001120, 	"2000001120",	"0x77359860",	"0b1110111001101011001100001100000");
	test(32767,		"32767",	"0x7fff",	"0b111111111111111");
	test(-32767,		"-32767",	"0xffff8001",	"0b11111111111111111000000000000001");
	test(999967233, 	"999967233",	"0x3b9a4a01",	"0b111011100110100100101000000001");
	test(1000032767, 	"1000032767",	"0x3b9b49ff",	"0b111011100110110100100111111111");
	test(1999967233, 	"1999967233",	"0x77351401",	"0b1110111001101010001010000000001");
	test(2000032767, 	"2000032767",	"0x773613ff",	"0b1110111001101100001001111111111");
	test(32768,		"32768",	"0x8000",	"0b1000000000000000");
	test(-32768,		"-32768",	"0xffff8000",	"0b11111111111111111000000000000000");
	test(999967232, 	"999967232",	"0x3b9a4a00",	"0b111011100110100100101000000000");
	test(1000032768, 	"1000032768",	"0x3b9b4a00",	"0b111011100110110100101000000000");
	test(1999967232, 	"1999967232",	"0x77351400",	"0b1110111001101010001010000000000");
	test(2000032768, 	"2000032768",	"0x77361400",	"0b1110111001101100001010000000000");
	test(32769,		"32769",	"0x8001",	"0b1000000000000001");
	test(-32769,		"-32769",	"0xffff7fff",	"0b11111111111111110111111111111111");
	test(999967231, 	"999967231",	"0x3b9a49ff",	"0b111011100110100100100111111111");
	test(1000032769, 	"1000032769",	"0x3b9b4a01",	"0b111011100110110100101000000001");
	test(1999967231, 	"1999967231",	"0x773513ff",	"0b1110111001101010001001111111111");
	test(2000032769, 	"2000032769",	"0x77361401",	"0b1110111001101100001010000000001");
	test(64000,		"64000",	"0xfa00",	"0b1111101000000000");
	test(-64000,		"-64000",	"0xffff0600",	"0b11111111111111110000011000000000");
	test(999936000, 	"999936000",	"0x3b99d000",	"0b111011100110011101000000000000");
	test(1000064000, 	"1000064000",	"0x3b9bc400",	"0b111011100110111100010000000000");
	test(1999936000, 	"1999936000",	"0x77349a00",	"0b1110111001101001001101000000000");
	test(2000064000, 	"2000064000",	"0x77368e00",	"0b1110111001101101000111000000000");
	test(65535,		"65535",	"0xffff",	"0b1111111111111111");
	test(-65535,		"-65535",	"0xffff0001",	"0b11111111111111110000000000000001");
	test(999934465, 	"999934465",	"0x3b99ca01",	"0b111011100110011100101000000001");
	test(1000065535, 	"1000065535",	"0x3b9bc9ff",	"0b111011100110111100100111111111");
	test(1999934465, 	"1999934465",	"0x77349401",	"0b1110111001101001001010000000001");
	test(2000065535, 	"2000065535",	"0x773693ff",	"0b1110111001101101001001111111111");
	test(65536,		"65536",	"0x10000",	"0b10000000000000000");
	test(-65536,		"-65536",	"0xffff0000",	"0b11111111111111110000000000000000");
	test(999934464, 	"999934464",	"0x3b99ca00",	"0b111011100110011100101000000000");
	test(1000065536, 	"1000065536",	"0x3b9bca00",	"0b111011100110111100101000000000");
	test(1999934464, 	"1999934464",	"0x77349400",	"0b1110111001101001001010000000000");
	test(2000065536, 	"2000065536",	"0x77369400",	"0b1110111001101101001010000000000");
	test(1000982,		"1000982",	"0xf4616",	"0b11110100011000010110");
	test(-1000982,		"-1000982",	"0xfff0b9ea",	"0b11111111111100001011100111101010");
	test(998999018, 	"998999018",	"0x3b8b83ea",	"0b111011100010111000001111101010");
	test(1001000982, 	"1001000982",	"0x3baa1016",	"0b111011101010100001000000010110");
	test(1998999018, 	"1998999018",	"0x77264dea",	"0b1110111001001100100110111101010");
	test(2001000982, 	"2001000982",	"0x7744da16",	"0b1110111010001001101101000010110");
	test(2147483647, 	"2147483647",	"0x7fffffff",	"0b1111111111111111111111111111111");
	test(2147483646, 	"2147483646",	"0x7ffffffe",	"0b1111111111111111111111111111110");
	test(-2147483648, 	"-2147483648",	"0x80000000",	"0b10000000000000000000000000000000");
	test(-2147483648, 	"-2147483648",	"0x80000000",	"0b10000000000000000000000000000000");
	test(2147483647, 	"2147483647",	"0x7fffffff",	"0b1111111111111111111111111111111");
	test(-2147483647, 	"-2147483647",	"0x80000001",	"0b10000000000000000000000000000001");

	test(2147483646, 	"2147483646",	"0x7fFFfffE",	"0b1111111111111111111111111111110");
	test(999934465, 	"999934465",	"0X3B99CA01",	"0B111011100110011100101000000001");
	test(1000065535, 	"1000065535",	"0X3B9BC9FF",	"0B111011100110111100100111111111");
	test(999999997, 	"999999997",	"0X3B9AC9FD",	"0B111011100110101100100111111101");
	test(-32768,		"-32768",	"0xFFFF8000",	"0b11111111111111111000000000000000");
	test(-32767,		"-32767",	"0xFFFF8001",	"0b11111111111111111000000000000001");
	test(-65536,		"-65536",	"0xFFFF0000",	"0b11111111111111110000000000000000");
	test(-65535,		"-65535",	"0xFFFF0001",	"0b11111111111111110000000000000001");
	test(32768,		"32768",	"0x8000",	"0b01000000000000000");
	test(32768,		"32768",	"0x8000",	"0b00001000000000000000");
	test(32768,		"32768",	"0x8000",	"0b00000000000000001000000000000000");

	test(3,			"3",		"0x3",		"0b0011");
	test(3,			"3",		"0x3",		"0b000011");
	test(3,			"3",		"0x3",		"0b0000011");
	test(3,			"3",		"0x3",		"0b0000000011");
}

def test_implicit_int(val: int, dec: string, hex: string, bin: string) {
	y_int(dec, val);
	y_int(hex, val);
	y_int(bin, val);
}

def test_explicit_uint(val: int, dec: string, hex: string, bin: string) {
	y_uint(dec, val);
	y_uint(hex, val);
	y_uint(bin, val);
}

def y_int(str: string, val: int) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (p.vtype != Int.TYPE) return TEST.error1("\"%1\" should be of type int", str);
	if (p.hasSuffix()) return TEST.error1("\"%1\" should not have explicit type", str);
	var v = p.val;
	if (v == null) return TEST.error1("\"%1\" was a null Val", val);
	if (!Box<int>.?(v)) return TEST.error2("\"%1\" was not an int box, was %2", str, V3.renderResult(v, null, _));
	var r = Int.unbox(v);
	if (val != r) return TEST.error2("\"%1\" parsed as %2", str, r);
}

def UINT_TYPE = Int.getType(false, 32);
def y_uint(str: string, val: int) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (p.vtype != UINT_TYPE) return TEST.error1("\"%1\" should be of type int", str);
	if (!p.hasSuffix()) return TEST.error1("\"%1\" should have explicit type", str);
	var v = p.val;
	if (v == null) return TEST.error1("\"%1\" was a null Val", val);
	if (!Box<int>.?(v)) return TEST.error2("\"%1\" was not an int box, was %2", str, V3.renderResult(v, null, _));
	var r = Int.unbox(v);
	if (val != r) return TEST.error2("\"%1\" parsed as %2", str, r);
}

def testHexLongs() {
	def test = y_long;
	test("0x000000000", (0, 0));
	test("0x00000000000000", (0, 0));
	test("0x000000000000000", (0, 0));
	test("0x0000000000000000", (0, 0));
	test("0x0000000000000001", (0, 1));
	test("0x0000000000000002", (0, 2));
	test("0x0000000000000003", (0, 3));
	test("0x0000000000000004", (0, 4));
	test("0x0000000000000005", (0, 5));
	test("0x0000000000000006", (0, 6));
	test("0x0000000000000007", (0, 7));
	test("0x0000000000000008", (0, 8));
	test("0x0000000000000009", (0, 9));
	test("0x000000000000000a", (0, 10));
	test("0x000000000000000b", (0, 11));
	test("0x000000000000000c", (0, 12));
	test("0x0000000000000010", (0x00000000, 0x00000010));
	test("0x0000000000000100", (0x00000000, 0x00000100));
	test("0x0000000000001000", (0x00000000, 0x00001000));
	test("0x0000000000010000", (0x00000000, 0x00010000));
	test("0x0000000000100000", (0x00000000, 0x00100000));
	test("0x0000000001000000", (0x00000000, 0x01000000));
	test("0x0000000010000000", (0x00000000, 0x10000000));
	test("0x0000000100000000", (0x00000001, 0x00000000));
	test("0x0000001000000000", (0x00000010, 0x00000000));
	test("0x0000010000000000", (0x00000100, 0x00000000));
	test("0x0000100000000000", (0x00001000, 0x00000000));
	test("0x0001000000000000", (0x00010000, 0x00000000));
	test("0x0010000000000000", (0x00100000, 0x00000000));
	test("0x0100000000000000", (0x01000000, 0x00000000));
	test("0x1000000000000000", (0x10000000, 0x00000000));

	test("0x0000000000000012", (0x00000000, 0x00000012));
	test("0x0000000000000123", (0x00000000, 0x00000123));
	test("0x000000000000123a", (0x00000000, 0x0000123a));
	test("0x00000000000123aF", (0x00000000, 0x000123aF));
	test("0x0000000000123aF0", (0x00000000, 0x00123aF0));
	test("0x000000000123aF00", (0x00000000, 0x0123aF00));
	test("0x00000000123aF000", (0x00000000, 0x123aF000));
	test("0x0000000123aF0000", (0x00000001, 0x23aF0000));
	test("0x000000123aF00000", (0x00000012, 0x3aF00000));
	test("0x00000123aF000000", (0x00000123, 0xaF000000));
	test("0x0000123aF0000000", (0x0000123a, 0xF0000000));
	test("0x000123aF00000000", (0x000123aF, 0x00000000));
	test("0x00123aF000000000", (0x00123aF0, 0x00000000));
	test("0x0123aF0000000000", (0x0123aF00, 0x00000000));
	test("0x123aF00000000000", (0x123aF000, 0x00000000));

	test("0xFFFFFFFFFFFFFFFF", (-1, -1));
	test("0xffffffffffffffff", (-1, -1));

	test("0x3b9a4a003b9b4a00", (999967232, 1000032768));
	test("0x7735140077361400", (1999967232, 2000032768));
	test("0x00008001ffff7fff", (32769, -32769));
	test("0x0008001ffff7fff",  (32769, -32769));
	test("0x008001ffff7fff",   (32769, -32769));
	test("0x08001ffff7fff",    (32769, -32769));
	test("0x8001ffff7fff",     (32769, -32769));
	test("0x3b9a49ff3b9b4a01", (999967231, 1000032769));
	test("0x773513ff77361401", (1999967231, 2000032769));
	test("0x0000fa00ffff0600", (64000, -64000));
	test("0x3b99d0003b9bc400", (999936000, 1000064000));
	test("0x77349a0077368e00", (1999936000, 2000064000));
	test("0x0000ffffffff0001", (65535, -65535));
	test("0x3b99ca013b9bc9ff", (999934465, 1000065535));
	test("0x77349401773693ff", (1999934465, 2000065535));
	test("0x00010000ffff0000", (65536, -65536));
	test("0x0010000ffff0000",  (65536, -65536));
	test("0x010000ffff0000",   (65536, -65536));
	test("0x10000ffff0000",    (65536, -65536));
	test("0x3b99ca003b9bca00", (999934464, 1000065536));
	test("0x7734940077369400", (1999934464, 2000065536));
	test("0x000f4616fff0b9ea", (1000982, -1000982));
	test("0x00f4616fff0b9ea",  (1000982, -1000982));
	test("0x0f4616fff0b9ea",   (1000982, -1000982));
	test("0xf4616fff0b9ea",    (1000982, -1000982));
	test("0x3b8b83ea3baa1016", (998999018, 1001000982));
	test("0x77264dea7744da16", (1998999018, 2001000982));
	test("0x7fffffff7ffffffe", (2147483647, 2147483646));
	test("0x8000000080000000", (-2147483648, -2147483648));
	test("0x7fffffff80000001", (2147483647, -2147483647));
}

def testDecLongs() {
	def test = y_long;
	test("6392438068", (0x00000001, 0x7D04DD34));
	test("19177314205", (0x00000004, 0x770E979D));
	test("57531942616", (0x0000000D, 0x652BC6D8));
	test("172595827849", (0x00000028, 0x2F835489));
	test("517787483548", (0x00000078, 0x8E89FD9C));
	test("1553362450645", (0x00000169, 0xAB9DF8D5));
	test("4660087351936", (0x0000043D, 0x02D9EA80));
	test("13980262055809", (0x00000CB7, 0x088DBF81));
	test("41940786167428", (0x00002625, 0x19A93E84));
	test("125822358502285", (0x0000726F, 0x4CFBBB8D));
	test("377467075506856", (0x0001574D, 0xE6F332A8));
	test("1132401226520569", (0x000405E9, 0xB4D997F9));
	test("3397203679561708", (0x000C11BD, 0x1E8CC7EC));
	test("10191611038685125", (0x00243537, 0x5BA657C5));
	test("30574833116055376", (0x006C9FA6, 0x12F30750));
	test("91724499348166129", (0x0145DEF2, 0x38D915F1));
	test("275173498044498388", (0x03D19CD6, 0xAA8B41D4));
	test("825520494133495165", (0x0B74D683, 0xFFA1C57D));
	test("2476561482400485496", (0x225E838B, 0xFEE55078));
	test("7429684447201456489", (0x671B8AA3, 0xFCAFF169));
	test("3842309267894817852", (0x35529FEB, 0xF60FD43C));

	test("-15690529805", (0xFFFFFFFC, 0x58C583F3));
	test("-47071589414", (0xFFFFFFF5, 0x0A508BDA));
	test("-141214768241", (0xFFFFFFDF, 0x1EF1A38F));
	test("-423644304722", (0xFFFFFF9D, 0x5CD4EAAE));
	test("-1270932914165", (0xFFFFFED8, 0x167EC00B));
	test("-3812798742494", (0xFFFFFC88, 0x437C4022));
	test("-11438396227481", (0xFFFFF598, 0xCA74C067));
	test("-34315188682442", (0xFFFFE0CA, 0x5F5E4136));
	test("-102945566047325", (0xFFFFA25F, 0x1E1AC3A3));
	test("-308836698141974", (0xFFFEE71D, 0x5A504AEA));
	test("-926510094425921", (0xFFFCB558, 0x0EF0E0BF));
	test("-2779530283277762", (0xFFF62008, 0x2CD2A23E));
	test("-8338590849833285", (0xFFE26018, 0x8677E6BB));
	test("-25015772549499854", (0xFFA72049, 0x9367B432));
	test("-75047317648499561", (0xFEF560DC, 0xBA371C97));
	test("-225141952945498682", (0xFCE02296, 0x2EA555C6));
	test("-675425858836496045", (0xF6A067C2, 0x8BF00153));
	test("-2026277576509488134", (0xE3E13747, 0xA3D003FA));
	test("-6078832729528464401", (0xABA3A5D6, 0xEB700BEF));

	test("9223372036854775807", (0x7FFFFFFF, 0xFFFFFFFF));
	test("-9223372036854775808", (0x80000000, 0));
}

def testBinLongs() {
	def test = y_long;
	test("0b00000101", (0x00000000, 0x00000005));
	test("0b0000010000", (0x00000000, 0x00000010));
	test("0b00000000000110001", (0x00000000, 0x00000031));
	test("0b0000000000000010010100", (0x00000000, 0x00000094));
	test("0b000000000000000110111101", (0x00000000, 0x000001BD));
	test("0b0000000000000000000010100111000", (0x00000000, 0x00000538));
	test("0b0000000000000000000000000000111110101001", (0x00000000, 0x00000FA9));
	test("0b00000000000000000000000000000010111011111100", (0x00000000, 0x00002EFC));
	test("0b00000000000000000000000000000001000110011110101", (0x00000000, 0x00008CF5));
	test("0b00000000000000000000000000011010011011100000", (0x00000000, 0x0001A6E0));
	test("0b0000000000000000000000000000001001111010010100001", (0x00000000, 0x0004F4A1));
	test("0b000000000000000000000000000000011101101110111100100", (0x00000000, 0x000EDDE4));
	test("0b00000000000000000000000000000001011001001100110101101", (0x00000000, 0x002C99AD));
	test("0b000000000000000000000000000000100001011100110100001000", (0x00000000, 0x0085CD08));
	test("0b00000000000000000000000000001100100010110011100011001", (0x00000000, 0x01916719));
	test("0b00000000000000000000100101101000011010101001100", (0x00000000, 0x04B4354C));
	test("0b000000000000000001110000111001001111111100101", (0x00000000, 0x0E1C9FE5));

	test("0b0000000000000000000000000000000000000000000000000000000000000101", (0x00000000, 0x00000005));
	test("0b0000000000000000000000000000000000000000000000000000000000010000", (0x00000000, 0x00000010));
	test("0b0000000000000000000000000000000000000000000000000000000000110001", (0x00000000, 0x00000031));
	test("0b0000000000000000000000000000000000000000000000000000000010010100", (0x00000000, 0x00000094));
	test("0b0000000000000000000000000000000000000000000000000000000110111101", (0x00000000, 0x000001BD));
	test("0b0000000000000000000000000000000000000000000000000000010100111000", (0x00000000, 0x00000538));
	test("0b0000000000000000000000000000000000000000000000000000111110101001", (0x00000000, 0x00000FA9));
	test("0b0000000000000000000000000000000000000000000000000010111011111100", (0x00000000, 0x00002EFC));
	test("0b0000000000000000000000000000000000000000000000001000110011110101", (0x00000000, 0x00008CF5));
	test("0b0000000000000000000000000000000000000000000000011010011011100000", (0x00000000, 0x0001A6E0));
	test("0b0000000000000000000000000000000000000000000001001111010010100001", (0x00000000, 0x0004F4A1));
	test("0b0000000000000000000000000000000000000000000011101101110111100100", (0x00000000, 0x000EDDE4));
	test("0b0000000000000000000000000000000000000000001011001001100110101101", (0x00000000, 0x002C99AD));
	test("0b0000000000000000000000000000000000000000100001011100110100001000", (0x00000000, 0x0085CD08));
	test("0b0000000000000000000000000000000000000001100100010110011100011001", (0x00000000, 0x01916719));
	test("0b0000000000000000000000000000000000000100101101000011010101001100", (0x00000000, 0x04B4354C));
	test("0b0000000000000000000000000000000000001110000111001001111111100101", (0x00000000, 0x0E1C9FE5));
	test("0b0000000000000000000000000000000000101010010101011101111110110000", (0x00000000, 0x2A55DFB0));
	test("0b0000000000000000000000000000000001111111000000011001111100010001", (0x00000000, 0x7F019F11));
	test("0b0000000000000000000000000000000101111101000001001101110100110100", (0x00000001, 0x7D04DD34));
	test("0b0000000000000000000000000000010001110111000011101001011110011101", (0x00000004, 0x770E979D));
	test("0b0000000000000000000000000000110101100101001010111100011011011000", (0x0000000D, 0x652BC6D8));
	test("0b0000000000000000000000000010100000101111100000110101010010001001", (0x00000028, 0x2F835489));
	test("0b0000000000000000000000000111100010001110100010011111110110011100", (0x00000078, 0x8E89FD9C));
	test("0b0000000000000000000000010110100110101011100111011111100011010101", (0x00000169, 0xAB9DF8D5));
	test("0b0000000000000000000001000011110100000010110110011110101010000000", (0x0000043D, 0x02D9EA80));
	test("0b0000000000000000000011001011011100001000100011011011111110000001", (0x00000CB7, 0x088DBF81));
	test("0b0000000000000000001001100010010100011001101010010011111010000100", (0x00002625, 0x19A93E84));
	test("0b0000000000000000011100100110111101001100111110111011101110001101", (0x0000726F, 0x4CFBBB8D));
	test("0b0000000000000001010101110100110111100110111100110011001010101000", (0x0001574D, 0xE6F332A8));
	test("0b0000000000000100000001011110100110110100110110011001011111111001", (0x000405E9, 0xB4D997F9));
	test("0b0000000000001100000100011011110100011110100011001100011111101100", (0x000C11BD, 0x1E8CC7EC));
	test("0b0000000000100100001101010011011101011011101001100101011111000101", (0x00243537, 0x5BA657C5));
	test("0b0000000001101100100111111010011000010010111100110000011101010000", (0x006C9FA6, 0x12F30750));
	test("0b0000000101000101110111101111001000111000110110010001010111110001", (0x0145DEF2, 0x38D915F1));
	test("0b0000001111010001100111001101011010101010100010110100000111010100", (0x03D19CD6, 0xAA8B41D4));
	test("0b0000101101110100110101101000001111111111101000011100010101111101", (0x0B74D683, 0xFFA1C57D));
	test("0b0010001001011110100000111000101111111110111001010101000001111000", (0x225E838B, 0xFEE55078));
	test("0b0110011100011011100010101010001111111100101011111111000101101001", (0x671B8AA3, 0xFCAFF169));
	test("0b0011010101010010100111111110101111110110000011111101010000111100", (0x35529FEB, 0xF60FD43C));
	test("0b1111111111111111111111111111111111111111111111111111111111111110", (0xFFFFFFFF, 0xFFFFFFFE));
	test("0b1111111111111111111111111111111111111111111111111111111111111011", (0xFFFFFFFF, 0xFFFFFFFB));
	test("0b1111111111111111111111111111111111111111111111111111111111110010", (0xFFFFFFFF, 0xFFFFFFF2));
	test("0b1111111111111111111111111111111111111111111111111111111111010111", (0xFFFFFFFF, 0xFFFFFFD7));
	test("0b1111111111111111111111111111111111111111111111111111111110000110", (0xFFFFFFFF, 0xFFFFFF86));
	test("0b1111111111111111111111111111111111111111111111111111111010010011", (0xFFFFFFFF, 0xFFFFFE93));
	test("0b1111111111111111111111111111111111111111111111111111101110111010", (0xFFFFFFFF, 0xFFFFFBBA));
	test("0b1111111111111111111111111111111111111111111111111111001100101111", (0xFFFFFFFF, 0xFFFFF32F));
	test("0b1111111111111111111111111111111111111111111111111101100110001110", (0xFFFFFFFF, 0xFFFFD98E));
	test("0b1111111111111111111111111111111111111111111111111000110010101011", (0xFFFFFFFF, 0xFFFF8CAB));
	test("0b1111111111111111111111111111111111111111111111101010011000000010", (0xFFFFFFFF, 0xFFFEA602));
	test("0b1111111111111111111111111111111111111111111110111111001000000111", (0xFFFFFFFF, 0xFFFBF207));
	test("0b1111111111111111111111111111111111111111111100111101011000010110", (0xFFFFFFFF, 0xFFF3D616));
	test("0b1111111111111111111111111111111111111111110110111000001001000011", (0xFFFFFFFF, 0xFFDB8243));
	test("0b1111111111111111111111111111111111111111100100101000011011001010", (0xFFFFFFFF, 0xFF9286CA));
	test("0b1111111111111111111111111111111111111110101101111001010001011111", (0xFFFFFFFF, 0xFEB7945F));
	test("0b1111111111111111111111111111111111111100001001101011110100011110", (0xFFFFFFFF, 0xFC26BD1E));
	test("0b1111111111111111111111111111111111110100011101000011011101011011", (0xFFFFFFFF, 0xF474375B));
	test("0b1111111111111111111111111111111111011101010111001010011000010010", (0xFFFFFFFF, 0xDD5CA612));
	test("0b1111111111111111111111111111111110011000000101011111001000110111", (0xFFFFFFFF, 0x9815F237));
	test("0b1111111111111111111111111111111011001000010000011101011010100110", (0xFFFFFFFE, 0xC841D6A6));
	test("0b1111111111111111111111111111110001011000110001011000001111110011", (0xFFFFFFFC, 0x58C583F3));
	test("0b1111111111111111111111111111010100001010010100001000101111011010", (0xFFFFFFF5, 0x0A508BDA));
	test("0b1111111111111111111111111101111100011110111100011010001110001111", (0xFFFFFFDF, 0x1EF1A38F));
	test("0b1111111111111111111111111001110101011100110101001110101010101110", (0xFFFFFF9D, 0x5CD4EAAE));
	test("0b1111111111111111111111101101100000010110011111101100000000001011", (0xFFFFFED8, 0x167EC00B));
	test("0b1111111111111111111111001000100001000011011111000100000000100010", (0xFFFFFC88, 0x437C4022));
	test("0b1111111111111111111101011001100011001010011101001100000001100111", (0xFFFFF598, 0xCA74C067));
	test("0b1111111111111111111000001100101001011111010111100100000100110110", (0xFFFFE0CA, 0x5F5E4136));
	test("0b1111111111111111101000100101111100011110000110101100001110100011", (0xFFFFA25F, 0x1E1AC3A3));
	test("0b1111111111111110111001110001110101011010010100000100101011101010", (0xFFFEE71D, 0x5A504AEA));
	test("0b1111111111111100101101010101100000001110111100001110000010111111", (0xFFFCB558, 0x0EF0E0BF));
	test("0b1111111111110110001000000000100000101100110100101010001000111110", (0xFFF62008, 0x2CD2A23E));
	test("0b1111111111100010011000000001100010000110011101111110011010111011", (0xFFE26018, 0x8677E6BB));
	test("0b1111111110100111001000000100100110010011011001111011010000110010", (0xFFA72049, 0x9367B432));
	test("0b1111111011110101011000001101110010111010001101110001110010010111", (0xFEF560DC, 0xBA371C97));
	test("0b1111110011100000001000101001011000101110101001010101010111000110", (0xFCE02296, 0x2EA555C6));
	test("0b1111011010100000011001111100001010001011111100000000000101010011", (0xF6A067C2, 0x8BF00153));
	test("0b1110001111100001001101110100011110100011110100000000001111111010", (0xE3E13747, 0xA3D003FA));
	test("0b1010101110100011101001011101011011101011011100000000101111101111", (0xABA3A5D6, 0xEB700BEF));
}

def testLSuffix() {
	def test = y_longl;
	test("0L", (0,0));
}

def testUnsigned() {
	def test = test_explicit_uint;
	test(0,			"0u",		"0x0u",		"0b0u");
	test(0,			"0u",		"0x000u",	"0b0000u");
	test(0,			"0u",		"0X0u",		"0B0u");
	test(0,			"0u",		"0X000u",	"0B0000u");
	test(1,			"1u",		"0x1u",		"0b1u");
	test(2,			"2u",		"0x2u",		"0b10u");
	test(3,			"3u",		"0x3u",		"0b11u");
	test(4,			"4u",		"0x4u",		"0b100u");
	test(5,			"5u",		"0x5u",		"0b101u");
	test(6,			"6u",		"0x6u",		"0b110u");
	test(7,			"7u",		"0x7u",		"0b111u");
	test(8,			"8u",		"0x8u",		"0b1000u");
	test(9,			"9u",		"0x9u",		"0b1001u");
	test(10,		"10u",		"0xau",		"0b1010u");
	test(11,		"11u",		"0xbu",		"0b1011u");
	test(12,		"12U",		"0xcu",		"0b1100u");
	test(13,		"13U",		"0xdU",		"0b1101u");
	test(14,		"14U",		"0xeU",		"0b1110u");
	test(15,		"15U",		"0xfU",		"0b1111u");
	test(16,		"16U",		"0x10u",		"0b10000U");
	test(17,		"17u",		"0x11U",		"0b10001U");
	test(18,		"18u",		"0x12u",		"0b10010U");
	test(23,		"23u",		"0x17U",		"0b10111U");
	test(42,		"42u",		"0x2au",		"0b101010U");
	test(56,		"56u",		"0x38u",		"0b111000U");
	test(1000000000,	"1000000000u",	"0x3b9aca00u",	"0b111011100110101100101000000000u");
	test(1000000000,	"1000000000u",	"0x3B9ACA00u",	"0b111011100110101100101000000000u");
	test(2000000000,	"2000000000u",	"0x77359400u",	"0b1110111001101011001010000000000u");
	test(2000000000,	"2000000000u",	"0x77359400u",	"0b1110111001101011001010000000000u");
	test(999999999, 	"999999999u",	"0x3b9ac9ffu",	"0b111011100110101100100111111111u");
	test(1000000001, 	"1000000001u",	"0x3b9aca01u",	"0b111011100110101100101000000001u");
	test(1999999999, 	"1999999999u",	"0x773593ffu",	"0b1110111001101011001001111111111u");
	test(2000000001, 	"2000000001u",	"0x77359401u",	"0b1110111001101011001010000000001u");
	test(999999998, 	"999999998u",	"0x3b9ac9feu",	"0b111011100110101100100111111110u");
	test(999999944, 	"999999944u",	"0x3b9ac9c8u",	"0b111011100110101100100111001000u");
	test(1000000056, 	"1000000056u",	"0x3b9aca38u",	"0b111011100110101100101000111000u");
	test(1999999944, 	"1999999944u",	"0x773593c8u",	"0b1110111001101011001001111001000u");
	test(2000000056, 	"2000000056u",	"0x77359438u",	"0b1110111001101011001010000111000u");
	test(77,		"77u",		"0x4du",		"0b1001101u");
	test(999999923, 	"999999923u",	"0x3b9ac9b3u",	"0b111011100110101100100110110011u");
	test(1000000077, 	"1000000077u",	"0x3b9aca4du",	"0b111011100110101100101001001101u");
	test(1999999923, 	"1999999923u",	"0x773593b3u",	"0b1110111001101011001001110110011u");
	test(2000000077, 	"2000000077u",	"0x7735944du",	"0b1110111001101011001010001001101u");
	test(101,		"101u",		"0x65u",		"0b1100101u");
	test(999999899, 	"999999899u",	"0x3b9ac99bu",	"0b111011100110101100100110011011u");
	test(1000000101, 	"1000000101u",	"0x3b9aca65u",	"0b111011100110101100101001100101u");
	test(125,		"125u",		"0x7du",		"0b1111101u");
	test(999999875, 	"999999875u",	"0x3b9ac983u",	"0b111011100110101100100110000011u");
	test(2000000125, 	"2000000125u",	"0x7735947du",	"0b1110111001101011001010001111101u");
	test(1001,		"1001u",		"0x3e9u",	"0b1111101001u");
	test(999998999, 	"999998999u",	"0x3b9ac617u",	"0b111011100110101100011000010111u");
	test(2000001001, 	"2000001001u",	"0x773597e9u",	"0b1110111001101011001011111101001u");
	test(1120,		"1120u",		"0x460u",	"0b10001100000u");
	test(999998880, 	"999998880u",	"0x3b9ac5a0u",	"0b111011100110101100010110100000u");
	test(1000001120, 	"1000001120u",	"0x3b9ace60u",	"0b111011100110101100111001100000u");
	test(1999998880, 	"1999998880u",	"0x77358fa0u",	"0b1110111001101011000111110100000u");
	test(2000001120, 	"2000001120u",	"0x77359860u",	"0b1110111001101011001100001100000u");
	test(32767,		"32767u",	"0x7fffu",	"0b111111111111111u");
	test(999967233, 	"999967233u",	"0x3b9a4a01u",	"0b111011100110100100101000000001u");
	test(1000032767, 	"1000032767u",	"0x3b9b49ffu",	"0b111011100110110100100111111111u");
	test(1999967233, 	"1999967233u",	"0x77351401u",	"0b1110111001101010001010000000001u");
	test(2000032767, 	"2000032767u",	"0x773613ffu",	"0b1110111001101100001001111111111u");
	test(32768,		"32768u",	"0x8000u",	"0b1000000000000000u");
	test(999967232, 	"999967232u",	"0x3b9a4a00u",	"0b111011100110100100101000000000u");
	test(1000032768, 	"1000032768u",	"0x3b9b4a00u",	"0b111011100110110100101000000000u");
	test(1999967232, 	"1999967232u",	"0x77351400u",	"0b1110111001101010001010000000000u");
	test(2000032768, 	"2000032768u",	"0x77361400u",	"0b1110111001101100001010000000000u");
	test(32769,		"32769u",	"0x8001u",	"0b1000000000000001u");
	test(999967231, 	"999967231u",	"0x3b9a49ffu",	"0b111011100110100100100111111111u");
	test(1000032769, 	"1000032769u",	"0x3b9b4a01u",	"0b111011100110110100101000000001u");
	test(1999967231, 	"1999967231u",	"0x773513ffu",	"0b1110111001101010001001111111111u");
	test(2000032769, 	"2000032769u",	"0x77361401u",	"0b1110111001101100001010000000001u");
	test(64000,		"64000u",	"0xfa00u",	"0b1111101000000000u");
	test(999936000, 	"999936000u",	"0x3b99d000u",	"0b111011100110011101000000000000u");
	test(1000064000, 	"1000064000u",	"0x3b9bc400u",	"0b111011100110111100010000000000u");
	test(1999936000, 	"1999936000u",	"0x77349a00u",	"0b1110111001101001001101000000000u");
	test(2000064000, 	"2000064000u",	"0x77368e00u",	"0b1110111001101101000111000000000u");
	test(65535,		"65535u",	"0xffffu",	"0b1111111111111111u");
	test(999934465, 	"999934465u",	"0x3b99ca01u",	"0b111011100110011100101000000001u");
	test(1000065535, 	"1000065535u",	"0x3b9bc9ffu",	"0b111011100110111100100111111111u");
	test(1999934465, 	"1999934465u",	"0x77349401u",	"0b1110111001101001001010000000001u");
	test(2000065535, 	"2000065535u",	"0x773693ffu",	"0b1110111001101101001001111111111u");
	test(65536,		"65536u",	"0x10000u",	"0b10000000000000000u");
	test(999934464, 	"999934464u",	"0x3b99ca00u",	"0b111011100110011100101000000000u");
	test(1000065536, 	"1000065536u",	"0x3b9bca00u",	"0b111011100110111100101000000000u");
	test(1999934464, 	"1999934464u",	"0x77349400u",	"0b1110111001101001001010000000000u");
	test(2000065536, 	"2000065536u",	"0x77369400u",	"0b1110111001101101001010000000000u");
	test(1000982,		"1000982u",	"0xf4616u",	"0b11110100011000010110u");
	test(998999018, 	"998999018u",	"0x3b8b83eau",	"0b111011100010111000001111101010u");
	test(1001000982, 	"1001000982u",	"0x3baa1016u",	"0b111011101010100001000000010110u");
	test(1998999018, 	"1998999018u",	"0x77264deau",	"0b1110111001001100100110111101010u");
	test(2001000982, 	"2001000982u",	"0x7744da16u",	"0b1110111010001001101101000010110u");
	test(2147483647, 	"2147483647u",	"0x7fffffffu",	"0b1111111111111111111111111111111u");
	test(2147483646, 	"2147483646u",	"0x7ffffffeu",	"0b1111111111111111111111111111110u");
	test(2147483647, 	"2147483647u",	"0x7fffffffu",	"0b1111111111111111111111111111111u");

	test(2147483646, 	"2147483646u",	"0x7fFFfffEu",	"0b1111111111111111111111111111110u");
	test(999934465, 	"999934465u",	"0X3B99CA01u",	"0B111011100110011100101000000001u");
	test(1000065535, 	"1000065535u",	"0X3B9BC9FFu",	"0B111011100110111100100111111111u");
	test(999999997, 	"999999997u",	"0X3B9AC9FDu",	"0B111011100110101100100111111101u");
	test(32768,		"32768u",	"0x8000u",	"0b01000000000000000u");
	test(32768,		"32768u",	"0x8000u",	"0b00001000000000000000u");
	test(32768,		"32768u",	"0x8000u",	"0b00000000000000001000000000000000u");

	test(3,			"3u",		"0x3u",		"0b0011u");
	test(3,			"3u",		"0x3u",		"0b000011u");
	test(3,			"3u",		"0x3u",		"0b0000011u");
	test(3,			"3u",		"0x3u",		"0b0000000011u");

	// TODO: test many unsigned numbers between 2^31 and 2^32
	test(-1,	"4294967295u",	"0xFFFFFFFFu",	"0b11111111111111111111111111111111u");
	test(-1,	"4294967295U",	"0xFFFFFFFFU",	"0b11111111111111111111111111111111U");
	test(-2,	"4294967294u",	"0xFFFFFFFEu",	"0b11111111111111111111111111111110u");
	test(-2,	"4294967294U",	"0xFFFFFFFEU",	"0b11111111111111111111111111111110U");

	test(-2147483648, "2147483648u",	"0x80000000u",	"0b10000000000000000000000000000000u");
	test(-2147483648, "2147483648U",	"0x80000000U",	"0b10000000000000000000000000000000U");
	test(-2147483640, "2147483656u",	"0x80000008u",	"0b10000000000000000000000000001000u");
	test(-2147483640, "2147483656U",	"0x80000008U",	"0b10000000000000000000000000001000U");
}

def testTypes() {
	def tint = test_type(_, Int.TYPE);
	def tlong = test_type(_, LONG_TYPE);
	def tuint = test_type(_, Int.getType(false, 32));
	def tulong = test_type(_, Int.getType(false, 64));

	tint("0");
	tint("1");
	tint("10");
	tint("21");
	tint("320");
	tint("311");
	tint("3410");
	tint("4521");
	tint("-1");
	tint("-10");
	tint("-21");
	tint("-320");
	tint("-311");
	tint("-3410");
	tint("-4521");

	tint("-214748362");
	tint("-214748363");
	tint("-214748366");
	tint("-2147483646");
	tint("-2147483647");
	tint("-2147483648");

	tint("214748362");
	tint("214748363");
	tint("214748366");
	tint("2147483646");
	tint("2147483647");

	tuint("0u");
	tuint("1u");
	tuint("10u");
	tuint("21u");
	tuint("320u");
	tuint("311u");
	tuint("3410U");
	tuint("4521U");

	tuint("4294967292u");
	tuint("4294967293u");
	tuint("4294967294u");
	tuint("4294967295u");

	tlong("0L");
	tlong("1L");
	tlong("10L");
	tlong("21L");
	tlong("320L");
	tlong("311L");
	tlong("3410l");
	tlong("4521l");
	tlong("-1L");
	tlong("-10L");
	tlong("-21L");
	tlong("-320L");
	tlong("-311L");
	tlong("-3410l");
	tlong("-4521l");

	tlong("-2147483649");
	tlong("-2147483650");
	tlong("-2147483651");
	tlong("-21474836480");

	tlong("2147483648");
	tlong("2147483649");
	tlong("2147483650");
	tlong("2147483651");
	tlong("21474836480");

	tulong("0uL");
	tulong("1uL");
	tulong("10uL");
	tulong("21uL");
	tulong("320UL");
	tulong("311UL");
	tulong("3410Ul");
	tulong("4521Ul");
	tulong("3410ul");
	tulong("4521ul");

	tulong("4294967296u");
	tulong("4294967297u");
	tulong("4294967298u");
	tulong("42949672950u");
	tulong("42949672951u");
}

def assert_f(str: string) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (!p.is_float) return TEST.error1("\"%1\" should have .is_float=true", str);
	if (p.vtype != Float.FLOAT32) TEST.error1("\"%1\" should be of type float", str);
}

def assert_d(str: string) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (!p.is_float) return TEST.error1("\"%1\" should have .is_float=true", str);
	if (p.vtype != Float.FLOAT64) TEST.error1("\"%1\" should be of type double", str);
}

def testFloatTypes() {
	assert_f("0f");
	assert_f("0F");
	assert_f("1f");
	assert_f("2f");
	assert_f("3f");
	assert_f("4f");
	assert_f("5f");
	assert_f("6f");
	assert_f("7f");
	assert_f("8f");
	assert_f("9f");
	assert_f("-0f");
	assert_f("-0F");
	assert_f("-1f");
	assert_f("-2f");
	assert_f("-3f");
	assert_f("-4f");
	assert_f("-5f");
	assert_f("-6f");
	assert_f("-7f");
	assert_f("-8f");
	assert_f("-9f");

	assert_d("0d");
	assert_d("0D");
	assert_d("1d");
	assert_d("2d");
	assert_d("3d");
	assert_d("4d");
	assert_d("5d");
	assert_d("6d");
	assert_d("7d");
	assert_d("8d");
	assert_d("9d");
	assert_d("-0");
	assert_d("-0d");
	assert_d("-0D");
	assert_d("-1d");
	assert_d("-2d");
	assert_d("-3d");
	assert_d("-4d");
	assert_d("-5d");
	assert_d("-6d");
	assert_d("-7d");
	assert_d("-8d");
	assert_d("-9d");

	assert_f("0.0f");
	assert_f("1.3f");
	assert_f("5.6f");
	assert_f("7.9f");
	assert_f("22.3f");
	assert_f("679.83f");

	assert_d("0.0d");
	assert_d("1.3d");
	assert_d("5.6d");
	assert_d("7.9d");
	assert_d("22.3d");
	assert_d("679.83d");

	assert_d("0.0");
	assert_d("1.3");
	assert_d("5.6");
	assert_d("7.9");
	assert_d("22.3");
	assert_d("679.83");
}
def test_type(str: string, t: Type) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (p.vtype != t) TEST.error2("\"%1\" should be of type %2", str, t.render);
}

def LONG_TYPE = Int.getType(true, 64);
def y_long(str: string, val: (int, int)) {
	var lval = long.!(val.0) << 32 | u32.!(val.1);
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (p.vtype != LONG_TYPE) return TEST.error1("\"%1\" should be of type long", str);
	if (p.hasSuffix()) return TEST.error1("\"%1\" should not have explicit type", str);
	var v = p.val;
	if (v == null) return TEST.error1("\"%1\" parsed to a null Val", str);
	if (!Box<long>.?(v)) return TEST.error2("\"%1\" was not an long box, was %2", str, V3.renderResult(v, null, _));
	var r = Box<long>.!(v).val;
	if (lval != r) return TEST.error2("\"%1\" parsed as %2", str, StringBuffer.putl(_, r));
}


def y_longl(str: string, val: (int, int)) {
	var p = NumberParser.new(str, 0);
	var lval = long.!(val.0) << 32 | u32.!(val.1);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (p.pos != str.length) return TEST.error1("\"%1\" did not match parsed length", str);
	if (p.vtype != LONG_TYPE) return TEST.error1("\"%1\" should be of type long", str);
	if (!p.hasSuffix()) return TEST.error1("\"%1\" should have explicit type", str);
	var v = p.val;
	if (v == null) return TEST.error1("\"%1\" parsed to a null Val", str);
	if (!Box<long>.?(v)) return TEST.error2("\"%1\" was not an long box, was %2", str, V3.renderResult(v, null, _));
	var r = Box<long>.!(v).val;
	if (lval != r) return TEST.error2("\"%1\" parsed as %2", str, StringBuffer.putl(_, r));
}

def n(str: string) {
	var p = NumberParser.new(str, 0);
	if (p.parse()) TEST.error1("\"%1\" should not parse", str);
}

def l(str: string, len: int) {
	var p = NumberParser.new(str, 0);
	if (!p.parse() || p.pos != len) TEST.error2("\"%1\" should parse of length %2", str, len);
}

def testInvalidFloats() {
	n("1e");
	n("1e+");
	n("1e-");
	n("1eA");
	n("1e+B");
	n("1e-F");
	n("--1");
}

def testFractional() {
	assert_d("9.0");
	assert_d("8.1");
	assert_d("7.22");
	assert_d("6.333");
	assert_d("5.4444");
	assert_d("4.55555");
	assert_d("3.666666");
	assert_d("2.7777777");
	assert_d("1.88888888");
	assert_d("0.999999999");
	assert_d("-1.88888888");
	assert_d("-0.999999999");

	n(".0");
	n(".1");
	n("-.0");
	n(".e");
	n(".E");
	n(".f");
	n(".d");
	n(".+");

	n("1.e");
	n("2.E");

	l("3.f", 3);
	l("-15.d", 5);
	l("5.+", 2);

	def invalid = "+-=_)(*&^%$#@!`~[{]}\\|;:\'\",<.>/? \t\nabcghijklmnopqrstuvwxyz";
	for (t in ["1. ", "-999. "]) {
		for (c in invalid) {
			t[t.length-1] = c;
			l(t, t.length-1);
		}
	}

	for (t in ["1.0 ", "-2.11 "]) {
		for (c in invalid) {
			t[t.length-1] = c;
			l(t, t.length-1);
		}
	}
}

def testExponent() {
	n("1e");
	n("2E");
	n("1e*");
	n("2E$");
	n("1e+*");
	n("2E-$");

	assert_d("9e0");
	assert_d("8e+0");
	assert_d("7e-0");
	assert_d("6E1");
	assert_d("5E+1");
	assert_d("4E-1");
	assert_d("-9e10");
	assert_d("-8e+20");
	assert_d("-7e-30");
	assert_d("-6E41");
	assert_d("-5E+51");
	assert_d("-4E-61");

	assert_f("9e5f");
	assert_f("8e+3F");
	assert_f("7e-2f");

	assert_d("1.0e1");
	assert_d("-3.0e22");
	assert_d("5.0e333");
	assert_d("-7.0e4444");
	assert_d("9.0e55555");
	assert_d("-22.0e666666");
	assert_d("444.0e7777777");
	assert_d("-6666.0e88888888");
	assert_d("88888.0e999999999");

	assert_d("1.0e-1");
	assert_d("3.0e-22");
	assert_d("5.0e-333");
	assert_d("7.0e-4444");
	assert_d("9.0e-55555");
	assert_d("22.0e-666666");
	assert_d("444.0e-7777777");
	assert_d("6666.0e-88888888");
	assert_d("88888.0e-999999999");

	def invalid = "+-=_)(*&^%$#@!`~[{]}\\|;:\'\",<.>/? \t\nabcghijklmnopqrstuvwxyz";
	for (t in ["1e0 ", "2E-11 "]) {
		for (c in invalid) {
			t[t.length-1] = c;
			l(t, t.length-1);
		}
	}
}

def assert_fv(str: string, bits: u32) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (!p.is_float) return TEST.error1("\"%1\" should have .is_float=true", str);
	if (p.vtype != Float.FLOAT32) return TEST.error1("\"%1\" should be of type float", str);
	if (!Float32Val.?(p.val)) return TEST.error1("\"%1\" should be Float32Val", str);
	var got = Float32Val.!(p.val).bits;
	if (bits != got) return TEST.error3("\"%1\" should be %2, got %3", str, bits, got);
}

def testFloatVal() {
	assert_fv("0f", 0x00000000);
	assert_fv("1f", 0x3F800000);
	assert_fv("2f", 0x40000000);
	assert_fv("3f", 0x40400000);
	assert_fv("4f", 0x40800000);
	assert_fv("5f", 0x40A00000);
	assert_fv("6f", 0x40C00000);
	assert_fv("7f", 0x40E00000);
	assert_fv("8f", 0x41000000);
	assert_fv("9f", 0x41100000);
	assert_fv("10f", 0x41200000);

	assert_fv("1e0f", 0x3F800000);
	assert_fv("2e0f", 0x40000000);
	assert_fv("3e0f", 0x40400000);
	assert_fv("4e0f", 0x40800000);

	assert_fv("1e+0f", 0x3F800000);
	assert_fv("2e+0f", 0x40000000);
	assert_fv("3e+0f", 0x40400000);
	assert_fv("4e+0f", 0x40800000);

	assert_fv("1e-0f", 0x3F800000);
	assert_fv("2e-0f", 0x40000000);
	assert_fv("3e-0f", 0x40400000);
	assert_fv("4e-0f", 0x40800000);

	assert_fv("1e1f", 0x41200000);
	assert_fv("2e1f", 0x41A00000);
	assert_fv("3e1f", 0x41F00000);
	assert_fv("4e1f", 0x42200000);

	assert_fv("-1e1f", 0xC1200000);
	assert_fv("-2e1f", 0xC1A00000);
	assert_fv("-3e1f", 0xC1F00000);
	assert_fv("-4e1f", 0xC2200000);

	assert_fv("7e2f", 0x442F0000);
	assert_fv("8e3f", 0x45FA0000);
	assert_fv("9e4f", 0x47AFC800);

	assert_fv("-5e5f", 0xC8F42400);
	assert_fv("-3e6f", 0xCA371B00);
	assert_fv("-6e7f", 0xCC64E1C0);

	assert_fv("123F", 0x42F60000);
	assert_fv("2345F", 0x45129000);
	assert_fv("34567F", 0x47070700);
	assert_fv("456789F", 0x48DF0AA0);

	assert_fv("16777214f", 0x4B7FFFFE);
	assert_fv("16777215f", 0x4B7FFFFF);
	assert_fv("16777216f", 0x4B800000);

	assert_fv("-33554430f", 0xCBFFFFFF);
	assert_fv("-33554431f", 0xCC000000);
	assert_fv("-33554432f", 0xCC000000);
	assert_fv("-33554433f", 0xCC000000);
	assert_fv("-33554434f", 0xCC000000);
	assert_fv("-33554435f", 0xCC000001);

	assert_fv("-335544331f", 0xCDA00000);
	assert_fv("-335544342f", 0xCDA00001);
	assert_fv("-335544353f", 0xCDA00001);

	assert_fv("-3355443316f", 0xCF480000);
	assert_fv("-3355443427f", 0xCF480001);
	assert_fv("-3355443538f", 0xCF480001);

	assert_fv("-3.355443316e9f", 0xCF480000);
	assert_fv("-3.355443427e9f", 0xCF480001);
	assert_fv("-3.355443538e9f", 0xCF480001);

	assert_fv("33554433160f", 0x50FA0001);
	assert_fv("33554434272f", 0x50FA0001);
	assert_fv("33554435384f", 0x50FA0002);
	assert_fv("33e12f", 0x55F01B4A);
	assert_fv("44e13f", 0x57C816BE);
	assert_fv("55e14f", 0x599C51C4);
	assert_fv("66e15f", 0x5B6A7AA6);
	assert_fv("77e16f", 0x5D2AF96F);
	assert_fv("88e17f", 0x5EF43FC3);
	assert_fv("99e18f", 0x60ABBCD5);

	assert_fv("3.3554433160e10f", 0x50FA0001);
	assert_fv("33.554433160e9f", 0x50FA0001);
	assert_fv("335.54433160e8f", 0x50FA0001);
	assert_fv("3355.4433160e7f", 0x50FA0001);
	assert_fv("33554.433160e6f", 0x50FA0001);
	assert_fv("335544.33160e5f", 0x50FA0001);
	assert_fv("3355443.3160e4f", 0x50FA0001);
	assert_fv("33554433.160e3f", 0x50FA0001);
	assert_fv("335544331.60e2f", 0x50FA0001);
	assert_fv("3355443316.0e1f", 0x50FA0001);

	assert_fv("3.3e13f", 0x55F01B4A);
	assert_fv("4.4e14f", 0x57C816BE);
	assert_fv("5.5e15f", 0x599C51C4);
	assert_fv("6.6e16f", 0x5B6A7AA6);
	assert_fv("7.7e17f", 0x5D2AF96F);
	assert_fv("8.8e18f", 0x5EF43FC3);
	assert_fv("9.9e19f", 0x60ABBCD5);

	assert_fv("3000000000000000000000000000000f", 0x72177617);
	assert_fv("3e30f", 0x72177617);

	assert_fv("7e20f", 0x6217C9CE);
	assert_fv("7e21f", 0x63BDBC42);
	assert_fv("7e22f", 0x656D2B52);
	assert_fv("7e23f", 0x67143B13);
	assert_fv("7e24f", 0x68B949D8);
	assert_fv("7e25f", 0x6A679C4E);
	assert_fv("7e26f", 0x6C10C1B1);
	assert_fv("7e27f", 0x6DB4F21D);
	assert_fv("7e28f", 0x6F622EA5);
	assert_fv("7e29f", 0x710D5D27);
	assert_fv("7e30f", 0x72B0B471);
	assert_fv("7e31f", 0x745CE18D);
	assert_fv("7e32f", 0x760A0CF8);
	assert_fv("7e33f", 0x77AC9036);
	assert_fv("7e34f", 0x7957B443);
	assert_fv("7e35f", 0x7B06D0AA);
	assert_fv("7e36f", 0x7CA884D5);
	assert_fv("7e37f", 0x7E52A60A);
	assert_fv("7e38f", 0x7F800000);
	assert_fv("7e39f", 0x7F800000);
	assert_fv("7e40f", 0x7F800000);
	assert_fv("7e41f", 0x7F800000);
	assert_fv("7e42f", 0x7F800000);

	assert_fv("7.0e20f", 0x6217C9CE);
	assert_fv("7.00e21f", 0x63BDBC42);
	assert_fv("7.000e22f", 0x656D2B52);
	assert_fv("7.0000e23f", 0x67143B13);

	assert_fv("71234567890f", 0x5184AF4A);
	assert_fv("712345678901234567890f", 0x621A7721);
	assert_fv("7123456789012345678901234567890f", 0x72B3D243);
	assert_fv("71234567890123456789012345678901234567890f", 0x7F800000);
	// TODO: tests for negative exponents and fractions

	assert_fv("0.1e1f", 0x3F800000);
	assert_fv("0.01e2f", 0x3F800000);
	assert_fv("0.001e3f", 0x3F800000);
	assert_fv("0.0001e4f", 0x3F800000);
	assert_fv("0.00001e5f", 0x3F800000);
	assert_fv("0.000001e6f", 0x3F800000);
	assert_fv("0.00000000000000000000000000000000000000001e36f", 0x3F800000);

	assert_fv("0e-0f", 0x00000000);
	assert_fv("0e-2f", 0x00000000);
	assert_fv("0e-32f", 0x00000000);
	assert_fv("-0e-0f", 0x80000000);
	assert_fv("-0e-32f", 0x80000000);

	assert_fv("0.0e-0f", 0x00000000);
	assert_fv("0.00e-2f", 0x00000000);
	assert_fv("0.000e-32f", 0x00000000);
	assert_fv("-0.0000e-0f", 0x80000000);
	assert_fv("-0.00000e-32f", 0x80000000);
}

def assert_dv(str: string, bits: u64) {
	var p = NumberParser.new(str, 0);
	if (!p.parse()) return TEST.error1("\"%1\" did not parse", str);
	if (!p.is_float) return TEST.error1("\"%1\" should have .is_float=true", str);
	if (p.vtype != Float.FLOAT64) return TEST.error1("\"%1\" should be of type float", str);
	if (!Float64Val.?(p.val)) return TEST.error1("\"%1\" should be Float64Val", str);
	var got = Float64Val.!(p.val).bits;
	if (bits != got) {
		var buf = StringBuffer.new();
		buf.format1("\"%1\" should be ", str);
		buf.putl(long.!(bits));
		buf.puts(", got ");
		buf.putl(long.!(got));
		return TEST.error(buf.toString());
	}
}

def testDoubleVal() {
	assert_dv("0d", 0x0000000000000000);
	assert_dv("1d", 0x3FF0000000000000);
	assert_dv("2d", 0x4000000000000000);
	assert_dv("3d", 0x4008000000000000);
	assert_dv("4d", 0x4010000000000000);

	assert_dv("-0d", 0x8000000000000000);
	assert_dv("-1d", 0xBFF0000000000000);
	assert_dv("-2d", 0xC000000000000000);
	assert_dv("-3d", 0xC008000000000000);
	assert_dv("-4d", 0xC010000000000000);

	assert_dv("5d", 0x4014000000000000);
	assert_dv("6d", 0x4018000000000000);
	assert_dv("7d", 0x401C000000000000);
	assert_dv("8d", 0x4020000000000000);
	assert_dv("9d", 0x4022000000000000);
	assert_dv("10d", 0x4024000000000000);
	assert_dv("11d", 0x4026000000000000);

	assert_dv("1e0", 0x3FF0000000000000);
	assert_dv("1e+0", 0x3FF0000000000000);
	assert_dv("1e-0", 0x3FF0000000000000);
	assert_dv("3e0", 0x4008000000000000);
	assert_dv("3e+0", 0x4008000000000000);
	assert_dv("3e-0", 0x4008000000000000);

	assert_dv("1e1d", 0x4024000000000000);
	assert_dv("1e+1d", 0x4024000000000000);
	assert_dv("3e1D", 0x403E000000000000);
	assert_dv("3e+1D", 0x403E000000000000);

	assert_dv("-5e5", 0xC11E848000000000);
	assert_dv("-3e6", 0xC146E36000000000);
	assert_dv("-9e9", 0xC200C388D0000000);

	assert_dv("-5.0e5", 0xC11E848000000000);
	assert_dv("-5.00e5", 0xC11E848000000000);
	assert_dv("-5.000e5", 0xC11E848000000000);
	assert_dv("-5.0000e5", 0xC11E848000000000);
	assert_dv("-5.00000e5", 0xC11E848000000000);

	assert_dv("2251799813685247d", 0x431FFFFFFFFFFFFC);
	assert_dv("2251799813685248d", 0x4320000000000000);
	assert_dv("2251799813685249d", 0x4320000000000002);
	assert_dv("2251799813685250d", 0x4320000000000004);

	assert_dv("-2251799813685250d", 0xC320000000000004);
	assert_dv("-2251799813685251d", 0xC320000000000006);

	assert_dv("4503599627370495d", 0x432FFFFFFFFFFFFE);
	assert_dv("4503599627370496d", 0x4330000000000000);
	assert_dv("4503599627370497d", 0x4330000000000001);

	assert_dv("-4503599627370497d", 0xC330000000000001);
	assert_dv("-4503599627370498d", 0xC330000000000002);

	assert_dv("9007199254740991d", 0x433FFFFFFFFFFFFF);
	assert_dv("9007199254740992d", 0x4340000000000000);
	assert_dv("9007199254740993d", 0x4340000000000000);
	assert_dv("9007199254740994d", 0x4340000000000001);
	assert_dv("9007199254740995d", 0x4340000000000002);

	assert_dv("18014398509481982d", 0x434FFFFFFFFFFFFF);
	assert_dv("18014398509481983d", 0x4350000000000000);
	assert_dv("18014398509481984d", 0x4350000000000000);
	assert_dv("18014398509481985d", 0x4350000000000000);
	assert_dv("18014398509481986d", 0x4350000000000000);

	assert_dv("2.251799813685247e15d", 0x431FFFFFFFFFFFFC);
	assert_dv("22.51799813685247e14d", 0x431FFFFFFFFFFFFC);
	assert_dv("225.1799813685247e13d", 0x431FFFFFFFFFFFFC);
	assert_dv("2251.799813685247e12d", 0x431FFFFFFFFFFFFC);
	assert_dv("22517.99813685247e11d", 0x431FFFFFFFFFFFFC);
	assert_dv("225179.9813685247e10d", 0x431FFFFFFFFFFFFC);
	assert_dv("2251799.813685247e9d", 0x431FFFFFFFFFFFFC);
	assert_dv("22517998.13685247e8d", 0x431FFFFFFFFFFFFC);
	assert_dv("225179981.3685247e7d", 0x431FFFFFFFFFFFFC);
	assert_dv("2251799813.685247e6d", 0x431FFFFFFFFFFFFC);
	assert_dv("22517998136.85247e5d", 0x431FFFFFFFFFFFFC);
	assert_dv("225179981368.5247e4d", 0x431FFFFFFFFFFFFC);
	assert_dv("2251799813685.247e3d", 0x431FFFFFFFFFFFFC);
	assert_dv("22517998136852.47e2d", 0x431FFFFFFFFFFFFC);

	assert_dv("5e16", 0x4366345785D8A000);
	assert_dv("5e17", 0x439BC16D674EC800);
	assert_dv("5e18", 0x43D158E460913D00);
	assert_dv("5e19", 0x4405AF1D78B58C40);
	assert_dv("5e20", 0x443B1AE4D6E2EF50);
	assert_dv("5e21", 0x4470F0CF064DD592);

	assert_dv("7e305", 0x7F6FE60E8164FD06);
	assert_dv("7e306", 0x7FA3EFC910DF1E24);
	assert_dv("7e307", 0x7FD8EBBB5516E5AD);
	assert_dv("7e308", 0x7FF0000000000000);
	assert_dv("7e309", 0x7FF0000000000000);

	assert_dv("7.0e305", 0x7F6FE60E8164FD06);
	assert_dv("7.1e305", 0x7F702D5B787A87A2);
	assert_dv("-7.01e305", 0xFF6FF1B8F2F3653F);
	assert_dv("7.0e306", 0x7FA3EFC910DF1E24);
	assert_dv("7.0e307", 0x7FD8EBBB5516E5AD);
	assert_dv("7.0e308", 0x7FF0000000000000);

	// TODO: tests for negative exponents and fractions

	assert_dv("0.1e1", 0x3FF0000000000000);
	assert_dv("0.01e2", 0x3FF0000000000000);
	assert_dv("0.001e3", 0x3FF0000000000000);
	assert_dv("0.0001e4", 0x3FF0000000000000);
	assert_dv("0.000000000000000000000000000000000000000000000000000001e54", 0x3FF0000000000000);

	assert_dv("0.18014398509481982e17d", 0x434FFFFFFFFFFFFF);
	assert_dv("0.0000018014398509481982e22d", 0x434FFFFFFFFFFFFF);
	assert_dv("-0.000000000018014398509481982e27d", 0xC34FFFFFFFFFFFFF);

	assert_dv("0e-0d", 0x0000000000000000);
	assert_dv("0e-2", 0x0000000000000000);
	assert_dv("0e-32d", 0x0000000000000000);
	assert_dv("-0e-0d", 0x8000000000000000);
	assert_dv("-0e-32d", 0x8000000000000000);

	assert_dv("0.0e-0d", 0x0000000000000000);
	assert_dv("0.00e-2", 0x0000000000000000);
	assert_dv("0.000e-32d", 0x0000000000000000);
	assert_dv("-0.0000e-0d", 0x8000000000000000);
	assert_dv("-0.00000e-32d", 0x8000000000000000);
}
