#!/bin/bash

BIN=$(cd $(dirname ${BASH_SOURCE[0]}) && pwd)
V3C_LINK=$BIN/v3c

PLATFORM=$(uname -sm)

if [[ "$PLATFORM" = "Darwin i386" || "$PLATFORM" = "Darwin x86_64" ]]; then
	# running on x86-darwin, search for suitable binaries
	for f in current bootstrap stable; do
		exe=$BIN/v3c-x86-darwin
		if [ -x "$exe" ]; then
			$exe $@
			exit $?
		fi
	done
fi

if [[ "$PLATFORM" = "Linux i386" || "$PLATFORM" = "Linux i686" || "$PLATFORM" = "Linux x86_64" ]]; then
	# running on x86-linux, search for suitable binaries
	for f in current bootstrap stable; do
		exe=$BIN/v3c-x86-linux
		if [ -x "$exe" ]; then
			$exe $@
			exit $?
		fi
	done
fi

JAVA=$(which java)

if [ ! -z "$JAVA" ]; then
	# java is supported, search for suitable binaries
	for f in current bootstrap stable; do
		exe=$BIN/v3c-jar
		if [ -x $exe ]; then
			$exe $@
			exit $?
		fi
	done
fi

echo v3c-host: no suitable host platforms available.
exit 1