def iobuf = Array<byte>.new(16);
def sizebuf = Array<byte>.new(16);

def main(a: Array<string>) -> int {
	var msg = "foo\n";

	/*for (i < 100000000)*/ {
		var ioptr = Pointer.atContents(iobuf);
		var sizeptr = Pointer.atContents(sizebuf);

		(ioptr + 0).store<int>(Pointer.atContents(msg) - Pointer.NULL);
		(ioptr + 4).store<int>(msg.length);

		var r = wasi_snapshot_preview1.fd_write(1, ioptr, 1, sizeptr);

		System.puts(msg);
	}
// TODO
//	System.puti(33);
//	System.putc('K');
//	System.ln();
//	wasi_snapshot_preview1.fd_flush(1);

	return 43;
}
