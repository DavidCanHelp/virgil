//@execute = 46
component avail01 {
	def SEEK_CUR: int = 1;
	def SEEK_END: int = 2;
	def SEEK_SET: int = 0;
	def main() -> int {
		return available(Linux.open(Pointer.atContents("test.txt\x00"), 0, 0));
	}
	def available(fd: int) -> int {
		var current = Linux.lseek(fd, 0, SEEK_CUR).0;
		if (current < 0) return 0;
		var end = Linux.lseek(fd, 0, SEEK_END).0;
		Linux.lseek(fd, current, SEEK_SET);
		return end - current;
	}
}
